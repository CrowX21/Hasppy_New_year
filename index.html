<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Happy New Year Neon</title>

<style>
body{
    margin:0;
    background:black;
    overflow:hidden;
    font-family:Arial,sans-serif;
}

/* ===== ROTATE INFO ===== */
#rotate-warning{
    position:fixed;
    inset:0;
    background:black;
    color:white;
    display:none;
    align-items:center;
    justify-content:center;
    text-align:center;
    z-index:10;
    font-size:clamp(14px,4vw,26px);
}

/* ===== COUNTDOWN ===== */
#countdown-wrapper{
    position:fixed;
    inset:0;
    display:flex;
    align-items:center;
    justify-content:center;
    padding:12vh 6vw;
    box-sizing:border-box;
    pointer-events:none;
}

#countdown{
    color:white;
    font-weight:bold;
    font-size:clamp(38px, 13vw, 110px);
    line-height:1.25;
    text-shadow:
        0 0 10px #00ffff,
        0 0 22px #00ffff,
        0 0 44px #00ffff;
}

canvas{
    position:fixed;
    inset:0;
}
</style>
</head>

<body>

<div id="rotate-warning">
    ðŸ”„<br><br>
    Putar HP ke <b>LANDSCAPE</b>
</div>

<div id="countdown-wrapper">
    <div id="countdown">10</div>
</div>

<canvas id="canvas"></canvas>

<script>
/* ===== ORIENTATION ===== */
const warn = document.getElementById("rotate-warning");
function checkOri(){
    warn.style.display = innerHeight > innerWidth ? "flex" : "none";
}
addEventListener("resize",checkOri);
addEventListener("orientationchange",checkOri);
checkOri();

/* ===== AUDIO PETASAN ===== */
const audioCtx=new (window.AudioContext||window.webkitAudioContext)();
["click","touchstart"].forEach(e=>{
    document.addEventListener(e,()=>{
        if(audioCtx.state==="suspended") audioCtx.resume();
    },{once:true});
});
function boom(p=1){
    const o=audioCtx.createOscillator();
    const g=audioCtx.createGain();
    o.type="square";
    o.frequency.value=120;
    g.gain.value=0.3*p;
    o.connect(g); g.connect(audioCtx.destination);
    o.start();
    o.frequency.exponentialRampToValueAtTime(40,audioCtx.currentTime+0.4);
    g.gain.exponentialRampToValueAtTime(0.01,audioCtx.currentTime+0.4);
    o.stop(audioCtx.currentTime+0.4);
}

/* ===== CANVAS ===== */
const canvas=document.getElementById("canvas");
const ctx=canvas.getContext("2d");
function resize(){
    const dpr=Math.min(devicePixelRatio||1,2);
    canvas.width=innerWidth*dpr;
    canvas.height=innerHeight*dpr;
    canvas.style.width=innerWidth+"px";
    canvas.style.height=innerHeight+"px";
    ctx.setTransform(dpr,0,0,dpr,0,0);
}
resize(); addEventListener("resize",resize);

/* ===== COUNTDOWN ===== */
let n=10;
const cd=document.getElementById("countdown");
const wrap=document.getElementById("countdown-wrapper");

const timer=setInterval(()=>{
    cd.textContent=n;
    boom(0.4);
    n--;
    if(n<0){
        clearInterval(timer);
        wrap.style.display="none";
        boom(2);
        startShow();
    }
},1000);

/* ===== BACKGROUND FIREWORK ===== */
let bg=[];
function spawnBG(){
    if(innerHeight>innerWidth) return;
    const x=Math.random()*innerWidth;
    const y=Math.random()*innerHeight*0.5;
    const count=innerWidth<700?30:60;
    for(let i=0;i<count;i++){
        const a=Math.random()*Math.PI*2;
        const s=Math.random()*4+2;
        bg.push({
            x,y,
            vx:Math.cos(a)*s,
            vy:Math.sin(a)*s,
            life:70,
            color:`hsl(${Math.random()*360},100%,60%)`
        });
    }
}
setInterval(spawnBG,900);

/* ===== TEXT FIREWORK (ANTI TERPOTONG) ===== */
let particles=[], phase="explode";

function fireworkText(text, yRatio, scale){
    const temp=document.createElement("canvas");
    const tctx=temp.getContext("2d");
    temp.width=innerWidth;
    temp.height=innerHeight;

    const safeTop=innerHeight*0.15;
    const safeBottom=innerHeight*0.85;
    const y=Math.min(Math.max(innerHeight*yRatio,safeTop),safeBottom);

    const maxFont=innerWidth<700?60:150;
    const fontSize=Math.min(innerWidth*scale, maxFont);

    tctx.fillStyle="white";
    tctx.textAlign="center";
    tctx.font=`bold ${fontSize}px Arial`;
    tctx.fillText(text,innerWidth/2,y);

    const data=tctx.getImageData(0,0,temp.width,temp.height).data;
    for(let py=0;py<temp.height;py+=10){
        for(let px=0;px<temp.width;px+=10){
            const i=(py*temp.width+px)*4;
            if(data[i+3]>150){
                const a=Math.random()*Math.PI*2;
                const s=Math.random()*5+2;
                particles.push({
                    x:innerWidth/2,y,
                    vx:Math.cos(a)*s,
                    vy:Math.sin(a)*s,
                    tx:px,ty:py,
                    color:`hsl(${Math.random()*360},100%,60%)`
                });
            }
        }
    }
    phase="explode";
    setTimeout(()=>phase="form",1300);
}

/* ===== SHOW ===== */
function startShow(){
    fireworkText("HAPPY NEW YEAR",0.45,0.16);
    setTimeout(()=>{
        fireworkText(new Date().getFullYear()+1,0.75,0.1);
    },1600);
}

/* ===== ANIMATE ===== */
function animate(){
    ctx.clearRect(0,0,innerWidth,innerHeight);

    if(innerHeight<=innerWidth){
        bg.forEach((p,i)=>{
            p.x+=p.vx; p.y+=p.vy;
            p.vy+=0.04; p.life--;
            ctx.shadowBlur=10;
            ctx.shadowColor=p.color;
            ctx.fillStyle=p.color;
            ctx.fillRect(p.x,p.y,2,2);
            if(p.life<=0) bg.splice(i,1);
        });

        particles.forEach(p=>{
            if(phase==="explode"){
                p.x+=p.vx; p.y+=p.vy;
                p.vx*=0.9; p.vy*=0.9;
            }else{
                p.x+=(p.tx-p.x)*0.08;
                p.y+=(p.ty-p.y)*0.08;
            }
            ctx.shadowBlur=14;
            ctx.shadowColor=p.color;
            ctx.fillStyle=p.color;
            ctx.fillRect(p.x,p.y,3,3);
        });
    }
    ctx.shadowBlur=0;
    requestAnimationFrame(animate);
}
animate();
</script>

</body>
</html>
